<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="BoardMapper">
  <insert id="reg" parameterType="bvo">
    INSERT INTO board (title, price, made_by, category, description, writer, image_file)
    VALUES (#{title}, #{price}, #{made_by}, #{category}, #{description}, #{writer}, #{image_file})
  </insert>
  
  <select id="list" resultType="bvo">
    SELECT bno, title, price, mod_at, read_count
    FROM board ORDER BY bno DESC
  </select>
  
  <select id="one" parameterType="long" resultType="bvo">
    SELECT
    bno, 
    title, 
    price, 
    made_by,
    reg_at, 
    writer, 
    category, 
    description, 
    mod_at, 
    read_count, 
    image_file
    FROM board WHERE bno=#{bno}
  </select>
  
  <update id="modify" parameterType="bvo">
    UPDATE board SET
    title=#{title},
    price=#{price}, 
    made_by=#{made_by},
    category=#{category},
    mod_at=now(),
    image_file=#{image_file}
    WHERE bno=#{bno}
  </update>
  
  <delete id="remove" parameterType="long">
    DELETE FROM board WHERE bno=#{bno}
  </delete>
  
  <update id="delFile" parameterType="Long">
  UPDATE board SET image_file=NULL WHERE bno=#{bno}
  </update>
  
  <select id="fileName" parameterType="long">
  SELECT image_file FROM board WHERE bno=#{bno}
  </select>
  
  <update id="rcUp" parameterType="hashmap">
  UPDATE board SET read_count = read_count + #{qty} WHERE bno=#{bno}
  </update>
</mapper>